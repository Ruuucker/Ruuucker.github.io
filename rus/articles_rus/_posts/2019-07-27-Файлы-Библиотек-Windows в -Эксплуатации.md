---
layout: post
tags:
  - articles_rus
  - windows
published: true
---
# Оглавление
{:.no_toc}

* toc
{:toc}

# Использование библиотечных файлов в эксплуатации

Библиотечные файлы были введены в Windows 7 и представляют собой способ просмотра содержимого множества каталогов в одном представлении. Например, библиотека «Изображения» на самом деле содержит местоположения C:\\Users\\User\\Pictures и C:\\Users\\Public\\Pictures. Microsoft реализует это путем создания файлов .library-ms внутри AppData. Файлы библиотеки ms (library-ms) являются XML и строяться по определанной схеме. Большинство типов файлов Microsoft .-ms являются XML. Схему легко найти в Интернете, описание элементов, однако, довольно расплывчато. Ниже приведен пример типичного файла library-ms.

![1]({{ site.baseurl }}/assets/img/posts/Windows-Library-Files/image2011.png){:class="imghalf"}

Этот пример имеет только одно местоположение, но в спецификации сказано, что у нас может быть столько сколько мы хотим. Все библиотеки, которые предоставляет Microsoft, имеют конкретных владельцев с сериализованными местоположениями. Это означает, что вы не можете переместить его с компьютера на компьютер или даже от одного пользователя к другому. Однако все элементы, которые привязывают его к определенной машине/пользователю/местоположению, являются необязательными. Части которые нас интересуют - это SearchConenectionDescription.

<br>
![1]({{ site.baseurl }}/assets/img/posts/Windows-Library-Files/image2012.png){:class="imghalf"}
<br>
								И шаблон элемента Info.
<br>
![1]({{ site.baseurl }}/assets/img/posts/Windows-Library-Files/image2013.png){:class="imghalf"}
<br>

SearchConnectionDescription позволяет вам выбрать, какие пути должны быть включены при объединении файлов в представление самой библиотеки. В этом разделе мы просто рассмотрим локальные возможности файлов библиотеки, это полезно во многих случаях. При выполнении кода, вы можете изменить url элемент поиска соединителя описания пути. Указание пути к несуществующей подпапке соединительной папки вызовет обработку оной. Это полезно при запуске выполнению кода через файлы ссылок. Это также приводит к освобождению COM-объектов (см. статью [CLSIDs и Соединительные Папки]({{ site.baseurl }}/rus/articles_rus/CLSIDs-и-папки-соединений/ "CLSIDs и Соединительные Папки")).

 
Раздел templateInfo позволяет пользователю выбрать представление проводника для папок / файлов. В тех случаях, когда вы используете рендеринг значков (например, файлы desktop.ini), вы можете изменить представление проводника с деталей на представление значков.


В качестве аспекта tradecraft вы можете выбрать для библиотеки значок (значок папки, значок корзины и т. Д.), Изменив элемент {iconReference}.

# Удаленная возможность файлов библиотеки

Этот раздел является продолжением первого. Чтобы понять эту возможность, вы можете прочитать раздел SearchConnectorDescription. Таким образом, возможности удаленного доступа еще не были проверены, но, как представляется, они могут использоваться для снятия отпечатков пальцев и удаленной атаки на машины. Часть url SearchConnectorDescription может указывать на вещи, отличные от файлов / папок / известных папок (CLSID). Фактически, URL может быть реальным URL или UNC-путем. Это означает, что когда файл библиотеки отображается (может быть помещен на съемный носитель или в сетевой ресурс), svchost пытается найти папку с помощью WebDAV в сети / в Интернете. Я не доказал возможность удаленной эксплуатации машины. Однако, как минимум, информация об ОС и IP отправляется с запросом на прослушивающий пост. Здесь можно использовать метод точки соединения на сервере WebDav, чтобы вызвать удаленное выполнение при визуализации файла библиотеки.

